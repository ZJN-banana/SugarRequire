<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>define test</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <link href="brtest.css" type="text/css" rel="stylesheet" />
    <script src="../src/sr.js"></script>
    <script src="../plugin/sr-debug.js"></script>
</head>

<body>

</body>
<script src="brtest.js"></script>
<script>
    brtest.config({
        title: "define Test"
    });
    brtest.test('define1', function(con) {
        var scriptEvent1 = R.scriptAgent('files/define1.js');
        scriptEvent1.on('done', function(e) {
            var data = e.data;
            con.equal('object test one', data, {
                val: "define1"
            });
        });
        var scriptEvent2 = R.scriptAgent('files/define2.js');
        scriptEvent2.on('done', function(e) {
            var data = e.data;
            con.equal('object test two', data, {
                val: "IamDefine2"
            });
        });
        var scriptEvent3 = R.scriptAgent('files/define3.js');
        scriptEvent3.on('done', function(e) {
            var data = e.data;
            con.equal('object test 3', data, {
                val: "IamModule3"
            });
        });
    });

    brtest.test('require define', function(con) {
        var r1 = require('files/define1', 'files/define2').done(function(data1, data2) {
            con.equal('done data 1', data1.val, "define1");
            con.equal('done data 2', data2.val, "IamDefine2");
        });
        r1.ready = function(data1, data2) {
            con.equal('ready data 1', data1.val, "define1");
            con.equal('ready data 2', data2.val, "IamDefine2");
        };
        r1.require('files/define3').done(function(data3) {
            con.equal('done data 3', data3.val, "IamModule3");
        });
    });
    brtest.test('relation require', function(con) {
        require('files/relateDefine2').done(function(rData) {
            con.equal('rDefine val', rData.val, 'relateDefineData222');
            con.equal('rDefine sub data1 val', rData.data1.val, 'relateDefineData');
            con.equal('rDefine sub data1 sub d1Data val', rData.data1.d1Data.val, 'define1');
            con.equal('rDefine sub data2 val', rData.data2.val, 'IamDefine2');
        });
    })
</script>

</html>