!function(t){"use strict";function n(){this._eves={}}function e(t){var e=this,r=e._e=new n;e.state=i,e.args=t;var a=e._next=[];r.last(o,function(){var t=function(){r.emit(s),delete e.data,e._par&&e._par._e.emit(u),t=null};if(a.length){l(a,function(t){t._init()});var n=0;r.on(u,function(){n++,a.length==n&&(t(),r.off(u))})}else t()})}function r(n,e,r){n=c(n),this._pub=e||{};var i=q.toProm(n,this);this._p=r?r.prom.apply(r,i):g.apply(t,i),this._args=n}var i="wait",a="pending",o="fulfilled",f="rejected",u="wood",s="fire",c=function(t){return Array.prototype.slice.call(t,0)},p=function(t){return Object.prototype.toString.call(t).toLowerCase().replace(/(\[object )|(])/g,"")},l=function(){return[].forEach?function(t,n){return t.forEach(n)}:function(t,n){for(var e=0,r=t.length;r>e;e++)n(t[e],e)}}(),h=function(t,n){for(var e in n)t[e]=n[e];return t},d=function(){var t=!1,n=[];return function(e){t||(t=!0,setTimeout(function(){for(var e=0;e<n.length;e++)n[e]();n=[],t=!1},0)),n.push(e)}}(),v=function(t){var n=t.match(/(.+\/).+/);return n&&n[1]},m=function(t){var n=t.split(/\//g),e=[];return l(n,function(t){return".."==t&&e.length&&".."!=e.slice(-1)[0]?void e.pop():void e.push(t)}),e.join("/")};n.fn=n.prototype,n.fn._get=function(t){return this._eves[t]||(this._eves[t]={e:[],o:[]})},n.fn.on=function(t,n){this._get(t).e.push(n)},n.fn.one=function(t,n){this._get(t).o.push(n)},n.fn.first=function(t,n){this._get(t).f=n},n.fn.last=function(t,n){this._get(t).l=n},n.fn.off=function(t){delete this._eves[t]},n.fn.emit=function(t,n){var e=this._get(t),r=e.f;r&&r({name:t,type:"first"},n),delete e.f;for(var i=e.o;i.length;)i.shift()({name:t,type:"one"},n);l(e.e,function(e){e({name:t,type:"on"},n)});var a=e.l;a&&a({name:t,type:"last"},n),delete e.l},e.fn=e.prototype,e.fn._init=function(){var t=this,n=t._e,e=t.args;t.state=a;var r,i=e.length,u=[];if(!i)return t.state=o,void n.emit(o,{datas:u,state:o});var s=function(e,c,p){n.emit(a,{data:e,state:c,no:p}),i--,i||(r?n.emit(f,r):(t.state=o,n.emit(o,{datas:u,state:o})),s=r=u=null,n.off(a),n.off(f),n.off(o))};l(e,function(n,e){n.call(t,function(t){u[e]=t,s(t,o,e)},function(n){t.state=f,r=r||[],r.push({no:e,data:n}),s(n,f,e)})})},e.fn.then=function(t){var n=this;return n._e.one(o,function(e,r){t.apply(n,r.datas)}),n},e.fn.catch=function(t){return this._e.one(f,function(n,e){t(e)}),this},e.fn.pend=function(t){return this._e.on(a,function(n,e){t(e)}),this},e.fn.prom=function(){var t=c(arguments),n=new e(t);return n._par=this,this._next.push(n),n},e.fn.send=function(t){return this.data=t,this},e.fn.gift=function(t){l(this._next,function(n){n.send(t)})},e.fn.fire=function(t){return this._e.one(s,t),this};var g=function(){var t=c(arguments),n=new e(t);return d(function(){n._init()}),n};r.fn=r.prototype,r.fn.require=function(){var t=new r(arguments,this._pub,this._p);return t},r.fn.pend=function(t){var n=this;return n._p.pend(function(e){var r;r=e.state!=o?h({val:n._args[e.no],no:e.no},e.data):h({val:n._args[e.no]},e),r.state==x&&S.error(h({args:n._args},r)),t.call(n,r)}),n},r.fn.fail=function(t){var n=this;return n._p.catch(function(n){var e=[];l(n,function(t){e.push(h({no:t.no},t.data))}),t(e)}),n},r.fn.done=function(t){var n=this;return n._p.then(function(){t.apply(n,arguments)}),n},r.fn.post=function(t){return this._p.send(t),this},r.fn.hand=function(t){return this._p.gift(t),this};var _=function(){var t=new r(arguments);return t},y="define",b="defer",w="loading",j="loaded",M="finish",x="error",P=document.head,D={},E={},k={paths:D,baseUrl:"",dataMap:E,tempM:{}},q={toProm:function(t,n){var e=[];return l(t,function(t){var r=q.getPath(t,n);e.push(q.agent(r,n))}),e},getPath:function(t,n){if(E[t])return t;if(!/^.+?\/\//.test(t)){/\?.+$/.test(t)||/.js$/.test(t)||(t+=".js");var e=t.match(/^\.\/(.+)/);t=e?v(n._pub.rel)+e[1]:k.baseUrl+t,t=m(t)}return t},agent:function(t){var n=E[t];if(!n){var e=[];n=E[t]={state:w,proms:e},n.script=q.loadScript(t,function(){var r=k.tempM,i=r.type||"file";switch(n.type=i,n.state=j,i){case y:q.setDefine(t,function(t){n.state=M,l(e,function(n){n.res(t)}),delete n.proms});break;case b:n.state=M;{n.m=r.val}l(e,function(n){q.runDefer(t,n.d,n.res,n.rej)});break;default:n.state=M,l(e,function(t){t.res()})}var a=r.ids;a&&("string"==p(a)?E[a]=n:"array"==p(a)&&l(a,function(t){E[t]=n})),k.tempM={}},function(){n.state=x,l(e,function(n){n.rej({state:x,url:t})}),k.tempM={}})}return function(e,r){switch(n.state){case M:switch(n.type){case y:e(n.m);break;case b:q.runDefer(t,this.data,e,r)}break;case w:case j:n.proms.push({res:e,rej:r,d:this.data})}}},loadScript:function(t,n,e){var r=document.createElement("script");return r.type="text/javascript",r.setAttribute("async",!0),r.onload=n,r.onerror=e,r.src=t,d(function(){P.appendChild(r)}),r},setDefine:function(t,n){var e,i=E[t],a=k.tempM,o=a.val;if("function"==p(o)){var f={},u={};e=_(),e._pub.rel=t;var s=!1;u.exports=o.call({FILE:t},function(){var n,i=arguments;return n=s?new r(i,{rel:t}):e.require.apply(e,i)},f,u)||f,s=!0,e._p.fire(function(){var t=u.exports;i.m=t,n(t)})}else i.m=o,n(o);return e},runDefer:function(t,n,e,i){var a=E[t],o=a.m;o.call({FILE:t,data:n},function(){return new r(arguments,{rel:t})},e,function(n){i({state:f,data:n,url:t})})},define:function(t,n){k.tempM={type:y,val:t,ids:n}},defer:function(t,n){k.tempM={type:b,val:t,ids:n}}},U=function(t,n){q.define.call(q,t,n)},L=function(t,n){q.defer.call(q,t,n)},S={config:function(t){k.baseUrl=t.baseUrl||"",h(D,t.paths)},define:U,defer:L,use:function(t){var n=q.getPath(t),e=E[n]||{},r=e.type;return r==y?e.m:r},remove:function(t){var n=q.getPath(t),e=E[n];return e?(delete E[n],!0):void 0},extend:function(t){t(k,q,r)},error:function(){},version:"3"},A=t.sr;if(A){var C=A.config;C&&S.config(C);var F=A.ready;F&&d(F)}t.require||(t.require=_),t.define||(t.define=U),t.defer||(t.defer=L),t.sr=S}(window);