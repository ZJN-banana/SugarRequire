!function(t){var e={},n={},r={paths:e,baseUrl:"",dataMap:n,tempM:{}},i="",a={config:function(t){r.baseUrl=t.baseUrl,l(e,t.paths)},use:function(){},has:function(){},"delete":function(){},extend:function(t){t(r,x)},version:"sugarRequire 2.0"},s=[],o=!1,u=document.getElementsByTagName("head")[0],c=function(){},f=function(t){o||(o=!0,setTimeout(function(){for(var t=0;t<s.length;t++)s[t]();s=[],o=!1},0)),s.push(t)},d=function(t){return Object.prototype.toString.call(t).toLowerCase().replace(/(\[object )|(])/g,"")},p=Object.create||function(t){var e=c;return e.prototype=t,new e},v=function(t){return Array.prototype.slice.call(t)},h=function(){return[].forEach?function(t,e){return t.forEach(e)}:function(t,e){for(var n=0,r=t.length;r>n;n++)reMap.push(e(t[n],n))}}(),l=function(t,e){for(var n in e)t[n]=e[n];return t},_=function(t){return t=t.replace(/\?.+$/,""),t.replace(/.js$/g,"")},g=function(t){return t.concat(".js")},m=function(t){var e="",n=t.split("/"),r=n.length-1;return h(n,function(t,n){r>n&&(e+=t+"/")}),e},y=function(){this._map={},this.sub=[],this._ever={}};y.fn=y.prototype,y.fn._get=function(t){return this._map[t]||(this._map[t]={eves:[]})},y.fn.off=function(t,e){var n=this._get(t);if(arguments.length||(delete this._map,this._map=[]),t&&!e&&(this._map[t].eves=[]),t&&e){var r=[];h(n.eves,function(t){t._call!=e&&r.push(t)}),n.eves=r}};var b=function(t,e,n,r){if(t){var i={data:t.data,name:e};return 1==t.type?n(i,r):2==t.type&&f(function(){n(i,r)}),!0}return!1};y.fn.on=function(t,e,n){var r=this._get(t),i=b(this._ever[t],t,e,n);i||r.eves.push({data:n,_call:e})},y.fn.one=function(t,e,n){var r=this._get(t),i=b(this._ever[t],t,e,n);i||r.eves.push({one:!0,data:n,_call:e})},y.fn.trigger=function(t,e){var n=this._get(t),r=n._first;r&&r._call({data:e,name:t},r.data);var i=[];h(n.eves,function(n){n._call({data:e,name:t},n.data),n.one||i.push(n)}),n.eves=i;var a=this.sub;h(a,function(n){n.trigger(t,e)});var s=n._last;s&&s._call({data:e,name:t},s.data)},y.fn.ever=function(t,e,n){var r={};r=n?{type:1,data:e}:{type:2,data:e},this._ever[t]=r,this.trigger(t,e),this.off(t)},y.fn.first=function(t,e,n){var r=this._get(t);r._first={data:n,_call:e}},y.fn.last=function(t,e,n){var r=this._get(t);r._last={data:n,_call:e}},y.fn.clone=function(){var t=new y;return t._ever=p(this._ever),this.sub.push(t),t};var E=function(t){y.apply(this,arguments),this._cid=0,this._dMap=[],this._isInit=!1,this._isCreate=!1,this._ceName=t||"chainend"};E.fn=E.prototype=p(y.prototype),E.fn.create=function(){this._isCreate=!0;var t=this,e=this._cid++;return function(n){t._cid--,t._dMap[e]=n,t._isInit&&0==t._cid&&t.trigger(t._ceName,t._dMap)}},E.fn.init=function(){this._isInit=!0,this._isCreate&&0==this._cid&&this.trigger(this._ceName,this._dMap)};var q=function(t,e){e?(this._origin=e,this._rEvent=new y):(this._origin=this._rEvent=new E,this._origin.init());var n=this,r=this._origin.create();this._rEvent.last("ready",function(){r()}),this._rEvent.on("ready",function(t){n.ready.apply(this,t.data)}),this.doing(function(t){n.loading(t)}),this.fail(function(t){n.error(t)}),this.pub={},this._urls=t,this._subRequire=[]};q.fn=q.prototype,q.fn.ready=c,q.fn.error=c,q.fn.loading=c,q.fn.done=function(t){return this._rEvent.on("ready",function(e){t.apply(this,e.data)}),this},q.fn.doing=function(t){return this._rEvent.on("loading",function(e){t(e.data)}),this},q.fn.fail=function(t){return this._rEvent.on("error",function(e){t(e.data)}),this},q.fn.post=function(t){return this.data=t,this},q.fn.require=function(){var t=v(arguments),e=new q(t,this._origin);return this._subRequire.push(e),e.pub=this.pub,e};var w=function(t){var e=document.createElement("script");return e.type="text/javascript",e.setAttribute("async",!0),e.src=t,e},M=function(t){var e=t.split(/\//g),n=[];return h(e,function(t){return".."==t?void n.pop():void n.push(t)}),n.join("/")},R=function(t,e){var n=t.split(/^.\//),a=t.match(/\?.+$/g)||[""];if(n.length>=2){var s=e+g(_(n[1]))+a[0];return s=s.replace(i,""),s=M(s)}var o=r.paths[t]||t;if(/.+:\/\//g.test(o))return o;var s=r.baseUrl.concat("/"+o);return g(_(s))+a[0]},x={setDefine:function(t){var e=r.tempM,n=d(e.value),i={exports:{}};switch(n){case"function":var a=!1,s=!1,o=new E("firstRequireEnd"),u=e.value.call({FILE:t.script.src},function(){a=!0;var e=x.require.apply({},arguments);if(e.pub._dir=m(t.script.src),!s){var n=o.create();e._rEvent.on("chainend",n)}return e},i.exports,i);s=!0,a?(o.init(),o.on("firstRequireEnd",function(){t.status="done",t.event.ever("done",i.exports)})):(u&&(i.exports=u),t.status="done",t.event.ever("done",i.exports));break;default:t.status="done",t.event.ever("done",e.value),i.exports=e.value}t.content=i},deferBrain:function(t){var e=t.event.sub;h(e,function(e){t.content.call({FILE:t.script.src,data:e.data},function(){var e=x.require.apply({},arguments);return e.pub._dir=m(t.script.src),e},function(t){e.trigger("done",t)},function(t){e.trigger("error",t)})}),t.event.sub=[]},mProcess:function(t){var e=t.event,n=r.tempM;switch(n.type){case"define":t.type="define",x.setDefine(t);break;case"defer":t.type="defer",t.content=n.value,x.deferBrain(t);break;default:t.type="file",t.status="done",e.ever("done")}r.tempM={}},loadScript:function(t,e){var n=w(t);n.onload=function(){e({status:"succeed",script:n})},n.onerror=function(){e({status:"error",script:n})},u.appendChild(n)},scriptAgent:function(t){var e="";return n[t]?(e=n[t],e.type?"defer"==e.type?(f(function(){x.deferBrain(e)}),e.event.clone()):e.event:e.event.clone()):(e=n[t]={status:"wait",event:new y},x.loadScript(t,function(t){l(e,t),e.event.ever(t.status),r.tempM.scriptData=e,x.mProcess(e)}),e.event.last("done",function(){e.event.sub=[]}),e.event.clone())},groupScript:function(t,e){var n=new E("allloadend");return h(t,function(t){var r=R(t,e.pub._dir),i=x.scriptAgent(r,e);e.data&&(i.data=e.data);var a=n.create();i.one("done",function(t){var e=t.data;n.trigger("loading",e),a(e)})}),n.init(),n},splitter:function(t){var e=t._urls,n=x.groupScript(e,t);n.on("allloadend",function(e){t._rEvent.trigger("ready",e.data),h(t._subRequire,function(t){x.splitter(t)})})},require:function(){var t=v(arguments),e=new q(t);return f(function(){x.splitter(e)}),e},define:function(t,e){r.tempM={type:"define",value:t,name:e}},defer:function(t,e){r.tempM={type:"defer",value:t,name:e}}};a.require=x.require,a.define=x.define,a.defer=x.defer,t.sr=a,!t.require&&(t.require=x.require),!t.define&&(t.define=x.define),!t.defer&&(t.defer=x.defer),i=m(location.href),t.BindEvent=y,t.GatherEvent=E,t.Require=q,t.R=x,t.baseResources=r,t.rootdir=i}(window);